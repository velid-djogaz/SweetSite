"use strict";var _express=_interopRequireDefault(require("express")),_nodeFetch=_interopRequireDefault(require("node-fetch"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}require("dotenv/config");var app=(0,_express.default)();app.use(_express.default.json()),app.use(_express.default.urlencoded({extended:!0}));var port=process.env.PORT||5500,environment=process.env.ENVIRONMENT||"sandbox",client_id=process.env.CLIENT_ID,client_secret=process.env.CLIENT_SECRET,endpoint_url="sandbox"===environment?"https://api-m.sandbox.paypal.com":"https://api-m.paypal.com";function get_access_token(){var e="".concat(client_id,":").concat(client_secret);return(0,_nodeFetch.default)(endpoint_url+"/v1/oauth2/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Basic ".concat(Buffer.from(e).toString("base64"))},body:"grant_type=client_credentials"}).then(function(e){return e.json()}).then(function(e){return e.access_token})}app.post("/create_order",function(o,c){get_access_token().then(function(e){var t={intent:o.body.intent.toUpperCase(),purchase_units:[{amount:{currency_code:"USD",value:"100.00"}}]},n=JSON.stringify(t);(0,_nodeFetch.default)(endpoint_url+"/v2/checkout/orders",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:n}).then(function(e){return e.json()}).then(function(e){c.send(e)})}).catch(function(e){console.log(e),c.status(500).send(e)})}),app.post("/complete_order",function(t,n){get_access_token().then(function(e){(0,_nodeFetch.default)(endpoint_url+"/v2/checkout/orders/"+t.body.order_id+"/"+t.body.intent,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then(function(e){return e.json()}).then(function(e){console.log(e),n.send(e)})}).catch(function(e){console.log(e),n.status(500).send(e)})}),app.get("/",function(e,t){t.sendFile(process.cwd()+"/index.html")}),app.get("/style.css",function(e,t){t.sendFile(process.cwd()+"/style.css")}),app.get("/script.js",function(e,t){t.sendFile(process.cwd()+"/script.js")}),app.listen(port,function(){console.log("Server listening at http://localhost:".concat(port))});
//# sourceMappingURL=index.min.js.map
